Find-Documents-with-a-Query-Filter.js


const findDocuments = function(db, callback) {
  //Get the documents collection
  const collection = db.collection('documents');
  // Find some documents
  collection.find({'a': 3}).toArray(function(err, docs) {
    assert.equal(err, null);
    console.log("Found the following records");
    console.log(docs);
    callback(docs);
  });
}



//Only the documents which match 'a' : 3 should be returned.

Update-a-Document.js

const updateDocument = function(db, callback) {
  //Get the documents collection
  const collection = db.collection('documents');
  // Update document where a is 2, set b equal to 1
  collection.updateOne({ a : 2 }
    , { $set: { b : 1 } }, function(err, result) {
      console.log("Updated the document with the field a equal to 2");
      callback(result);
    });
}

insertDocuments.js

const insertDocuments = function(db, callback) {
  //Get the documents collection
  const collection = db.collection('documents');
  // Insert some documents
  collection.insertMany([
    {a : 1}, {a : 2}, {a : 3}
  ], function(err, result) {
    console.log("Inserted 3 documents into the collection");
    callback(result);
  });
}


//}}}]}

Import-module.js

const MongoClient = require('mongodb').MongoClient;
const assert = require('assert');
const rm = require('./removeDocument.js'); //Connection URL
//const rm = require ('./removeDocument.js')
const url = 'mongodb://localhost:27017';
// Database Name
const dbName = 'myproject';

//New paramaster for mongodb connection
var useNewUrlParser = true;
var useUnifiedTopology = true;
// Use connect method to connect to the server
MongoClient.connect(url,{
  useNewUrlParser,
  useUnifiedTopology
}, function(err, client) {
  console.log("Connected successfully to server");
  //const db = client.db(dbName);

  const collection = client.db(dbName).collection('documents');
  collection.deleteOne({ a : 3 });
  console.log("Delete sucesses")
  collection.updateOne({ a : 2 },
    { $set: { b : 1} } );
  console.log ("Update sucess . Dung kho");
  //insertDocuments(db, function(){
  //Call back function is pipeline
  //
  /*
    rm.save(db, function(){
      updateDocument(db, function(){
       client.close() ;
        //   })
    })
    */
  //})
});

//insertDocuments(dbName);
const insertDocuments = function(db, callback) {
  const collection = db.collection('documents');
  collection.insertMany([
    {a : 1}, {a : 2}, {a : 3}
  ], function(err, result) {
    console.log("Inserted 3 documents into the collection");
    callback(result);
  });
}

//Add a query documents
//Defined callback function day con gi
/*
const findDocuments = function(db, callback){
  const collection = db.collection('documents')
  collection.find({}).toArray(function(err, docs){
    console.log('Found the following records') ;
    console.log(docs);
    callback();
  })
}
*/
//Defined callback function - find documents with a query filter

const findDocuments = function(db, callback){
  const collection = db.collection('documents')
  collection.find({'a': 3}).toArray(function(err, docs){
    console.log("Found the following records") ;
    console.log(docs);
    callback(result);
  })
}

//Defined callback function - Update a document

const updateDocument = function(db, callback){
  const collection = db.collection('documents');
  collection.updateOne({ a : 2 }
    ,{ $set: { b : 1 } }, function(err, result){
      console.log("Update the document with the field a equal to 2") ;
      callback(result);
    })
}

//Remove callback function
  /*
const removeDocument = function(db, callback){
  const collection = db.collection('documents');
  collection.deleteOne({ a : 3 }, function (err, result){
    assert.equal(err, null);
    assert.equal(1, result.result.n);

    console.log("Removed the document with the filed a equal to 3");
    callback(result);
  })
}
*/

.eslintrc.js

module.exports = {
    "env": {
        "browser": true,
        "es6": true
    },
    "extends": "eslint:recommended",
    "globals": {
        "Atomics": "readonly",
        "SharedArrayBuffer": "readonly"
    },
    "parserOptions": {
        "ecmaVersion": 2018,
        "sourceType": "module"
    },
    "rules": {
    }
};
Connnect-to-mongodb.js

const MongoClient = require('mongodb').MongoClient;
const assert = require('assert');

Connection URL
const url = 'mongodb://localhost:27017';

// Database Name
const dbName = 'myproject';

// Use connect method to connect to the server
MongoClient.connect(url, function(err, client) {
  assert.equal(null, err);
  console.log("Connected successfully to server");

  const db = client.db(dbName);

  client.close();
});


Remove-a-Document.js

const removeDocument = function(db, callback) {
  // Get the documents collection
  const collection = db.collection('documents');
  // Delete document where a is 3
  collection.deleteOne({ a : 3 }, function(err, result) {
    assert.equal(err, null);
    assert.equal(1, result.result.n);
    console.log("Removed the document with the field a equal to 3");
    callback(result);
  });
}

Index-collection.js

//Index a Collection
//Indexes can improve your application's performance. The following function creates an index on the a field in the documents collection.

const indexCollection = function(db, callback) {
  db.collection('documents').createIndex(
    { "a": 1 },
    null,
    function(err, results) {
      console.log(results);
      callback();
    }
  );
};


//Add the indexCollection method to your app:

const MongoClient = require('mongodb').MongoClient;
const assert = require('assert');

//Connection URL
const url = 'mongodb://localhost:27017';

const dbName = 'myproject';

// Use connect method to connect to the server
MongoClient.connect(url, function(err, client) {
  assert.equal(null, err);
  console.log("Connected successfully to server");

  const db = client.db(dbName);

  insertDocuments(db, function() {
    indexCollection(db, function() {
      client.close();
    });
  });
});

Module-export-remove-Document.js

exports.remove = function(db, callback){
  const collection = db.collection('documents');
  collection.deleteOne({ a : 3 }, function (err, result){

    console.log("Removed the document with the filed a equal to 3");
    callback(result);
  })
}
exports.save = function(db, callback){
  const collection = db.collection('documents');
  collection.deleteOne({ a : 3 }, function (err, result){

    console.log("Removed the document with the filed a equal to 3");
    callback(result);
  })
}


FindDocuments.js

const findDocuments = function(db, callback) {
  //Get the documents collection
  const collection = db.collection('documents');
  // Find some documents
  collection.find({}).toArray(function(err, docs) {
    console.log("Found the following records");
    console.log(docs)
    callback(docs);
  });
}

