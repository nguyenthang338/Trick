Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Photo by Aleksi Tappura on Unsplash

Writing a CRUD app with Node.js
and¬†MongoDB
Eslam Maged Follow
Mar 27, 2018 ¬∑ 11 min read

Since you are here, I will assume you know the following:
1- A bit of JavaSript. (If not, you can have a look over the introductory JS guide
from Mozilla )
2- Heard of Node.js and curious about seeing it in action.

. . .

Basics:Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

CRUD Operations:
CRUD stands for Create, Read, Update and Delete. Which are the basic
operations that a simple web app would be designed to achieve.

REST:
If you didn‚Äôt hear about REST before, you can read more about it here.
In this tutorial, we will be designing an API for a Products app.

Getting Started:1- Install Node.js from the Node.js website
2- I‚Äôve created a directory called ‚ÄòProductsApp‚Äô.
3- Inside the newly created directory, execute the following command in the
terminal

npm init

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Initialize our Node.js project with default settings

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

The above commands results in creating a package.json le. The package.json
le is used to manage the locally installed npm packages. It also includes the
meta data about the project such as name and version number.
Afterwards, we need to install the packages we will be using for our API
The packages are:
1- ExpressJS: It‚Äôs a exible Node.JS web appplication that has many features
for web and mobile applications
2- mongoose: the mongoDB ODM for Node.JS.
3- body-parser: package that can be used to handle JSON requests.
We can install the above mentioned packages via typing the following
commands in the command line. Just make sure that you are in the project
directory before executing the below command.

npm install --save express body-parser mongoose

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Changes that took place in our package.json le after executing the above command

. . .

Initializing the Server:Create a new le, let‚Äôs name it app.js directly inside the ProductsApp directory

touch app.js

Open the newly created le named app.js and require all the dependencies
we previously installed (ExpressJS and body-parser ) -we will talk about
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

mongoose later-

// app.js
const express = require('express');
const bodyParser = require('body-parser');
// initialize our express app
const app = express();

Next step would be dedicating a port number and telling our express app to
listen to that port.

let port = 1234;
app.listen(port, () => {
console.log('Server is up and running on port numner ' + port);
});

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

How our app.js looks so far‚Ä¶

Now, we should be able to test our server using the following command in the
terminal

node app.js

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Message that appears when running the server

Now we made sure that we are having a server that is up and running.
However, this server does nothing! Let‚Äôs work on that and make our app more
complex.

Organizing our application:
We will be working with a design pattern called MVC. Its a neat way of
separating parts of our app and grouping them based on their functionality
and role. M stands for models, this will include all the code for our database
models (which in this case will be Products). Then comes the V which stands
for the views or the layout. We will not cover the views in this tutorial as we
are designing an API. The remaining part now is the C, which stands for
controllers which is the logic of how the app handles the incoming requests
and outgoing responses. There will be one more thing, called Routes, Routes
are our guide, they tell the client (browser/mobile app) to go to which
Controller once a speci c url/path is requested.
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Inside the ProductsApp directory, I will create the following four
subdirectories
1- controllers
2- models
3- routes
4- views

App structure

Now we have a server that is ready to handle our requests and some
directories that would have our code.

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Let‚Äôs start by de ning our model. Create a new le in the models directory
and let‚Äôs name it product.model.js

const mongoose = require('mongoose');
const Schema = mongoose.Schema;
let ProductSchema = new Schema({
name: {type: String, required: true, max: 100},
price: {type: Number, required: true},
});

// Export the model
module.exports = mongoose.model('Product', ProductSchema);

First we started with requiring mongoose and then we de ne the schema for
our model. Last thing is exporting the model so it can be used by other les in
our project.
Now we are done with the M part
Routes:
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Let‚Äôs start imagining how the urls will be like. Let‚Äôs desigin our routes.
Inside the routes directory, create a product.route.js le. This is the le that
will include the routes of the products. Some developers prefer to have all the
routes in a single le (routes.js) for example but this is not helpful when your
app grows! so let‚Äôs structure it the right way from the beginning.

const express = require('express');
const router = express.Router();
// Require the controllers WHICH WE DID NOT CREATE YET!!
const product_controller =
require('../controllers/product.controller');

// a simple test url to check that all of our files are
communicating correctly.
router.get('/test', product_controller.test);
module.exports = router;

Controllers:

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Next step is to implement the controllers we referenced them in the routes
go to our controllers directory and create a new js le named
product.controller.js which will be the placeholder for our controllers.

const Product = require('../models/product.model');
//Simple version, without validation or sanitation
exports.test = function (req, res) {
res.send('Greetings from the Test controller!');
};

Last step before trying out our rst route is to add the route class to the app.js

//app.js
const express = require('express');
const bodyParser = require('body-parser');
const product = require('./routes/product.route'); // Imports routes
for the products
const app = express();
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

app.use('/products', product);
let port = 1234;
app.listen(port, () => {
console.log('Server is up and running on port numner ' + port);
});

Now head to your browser and try the following link:
http://localhost:1234/products/test

Validating that our test route is working‚Ä¶

Now we have our very rst route working. Let‚Äôs get the rest working‚Ä¶.

. . .

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Postman:

. . .

Postman is a very powerful HTTP client that is used for testing, documenting
and the development of APIs. We will be using Postman here to test our
endpoints that we will be implementing through out the rest of the tutorial.
But rst, let‚Äôs get familiar with Postman using our ‚Äò/test‚Äô route.
1- Install Postman from their website.
2- Open the app, make sure it‚Äôs a GET request and type the following url
‚Äòlocalhost:1234/products/test‚Äô. Just make sure that your server is still running
on the port number 1234. You should be able to see ‚ÄòGreetings from Test
controller‚Äô when going on the ‚ÄòPreview‚Äô mode in Postman.

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Trying test route on Postman

. . .

The Database:
Our database will be hosted remotely on mLab. mLab o ers a nice free tier
that we can use to test our application. Let‚Äôs set it up quickly‚Ä¶
1- Head to mLab‚Äôs website.
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

https://mlab.com/

2- Click on ‚ÄòCreate New‚Äô from the above image.

Screen on creating a new image

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

3- Select the Sandbox Plan Type and click on ‚ÄòContinue‚Äô.

Naming our database

4- Type in the database name. I am using ‚Äòproductstutorial‚Äô as the database
name for this example.

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Submit order screen.

5- Once everything is ready, just click on ‚ÄòSubmit Order‚Äô

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Viewing our created database

6- Next step would be creating a user to be able to access the database. Simply
click on ‚ÄòAdd database user‚Äô

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

create a new user for accessing the database

7- Last step would be entering the data from the database user you are
creating. In this tutorial, for the username I will be using ‚Äòsomeuser‚Äô and for
the password I will be using ‚Äòabcd1234‚Äô.
Now we have a database in the cloud that is ready to be accessed¬†:-)

. . .

Connecting our app to the remote Database:
We need to inform our app that it should be communicating with the
database we have just created on mLab.
Remember the ‚Äòmongoose‚Äô package we installed before? Now is the right time
to use.

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

All we have to go is heading to our app.js le and paste the following code in
it. Just remember to update the dev_db_url variable with the connection
string of your remote database on mLab. Remote database string consists of
your database username and password, separated by a ‚Äò:‚Äô and then the URL to
your database instance on mLab and then the database name.

// Set up mongoose connection
const mongoose = require('mongoose');
let dev_db_url =
'mongodb://someuser:abcd1234@ds123619.mlab.com:23619/productstutoria
l';
let mongoDB = process.env.MONGODB_URI || dev_db_url;
mongoose.connect(mongoDB);
mongoose.Promise = global.Promise;
let db = mongoose.connection;
db.on('error', console.error.bind(console, 'MongoDB connection
error:'));

. . .

Body Parser
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Last con guration thingy we need for our app.js is using bodyParser. Body
Parser is an npm package that is used to parse the incoming request bodies in
a middleware.
In you app.js le, add the following couple of lines.

app.use(bodyParser.json());
app.use(bodyParser.urlencoded({extended: false}));

Here is how our full app.js le looks like

// app.js
const express = require('express');
const bodyParser = require('body-parser');
const product = require('./routes/product.route'); // Imports routes
for the products
const app = express();
// Set up mongoose connection
const mongoose = require('mongoose');
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

let dev_db_url =
'mongodb://someuser:abcd1234@ds123619.mlab.com:23619/productstutoria
l';
const mongoDB = process.env.MONGODB_URI || dev_db_url;
mongoose.connect(mongoDB);
mongoose.Promise = global.Promise;
const db = mongoose.connection;
db.on('error', console.error.bind(console, 'MongoDB connection
error:'));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({extended: false}));
app.use('/products', product);
let port = 1234;
app.listen(port, () => {
console.log('Server is up and running on port numner ' + port);
});

By now our app.js le is nalized and you are aware of the usage of each and
every line of code in the le.

. . .

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Implementing the endpoints
CREATE
The rst task in our CRUD task is to create a new product. Let‚Äôs start by
de ning our route rst. Head to routes and start designing the expected path
that the browser would hit and the controller that would be responsible for
handling that request.

// routes/products.route.js
...
router.post('/create', product_controller.product_create);

Now let‚Äôs write the product_create controller in our controller le. Head to
controllers/product.controller.js and paste the following code.

// controllers/products.js
exports.product_create = function (req, res) {
let product = new Product(
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

{
name: req.body.name,
price: req.body.price
}
);
product.save(function (err) {
if (err) {
return next(err);
}
res.send('Product Created successfully')
})
};

What the function does is it simply created a new product using the data
coming from a POST request and saves it to our database.
Last step would be validating that we can easily create a new product. Let‚Äôs
open Postman. Let‚Äôs send a POST request to the following url
‚Äòlocalhost:1234/products/create‚Äô and specify the POST data as name: apple
and price: 15 as a test example. Also make sure that you choose x-www-formurlencoded in the Body tab in Postman as speci ed in the image below.

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Postman post request example

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

We can see that the response is ‚ÄòProduct Created successfully. This means that
the router and the controller are working correctly. To double check that an
‚ÄòApple‚Äô product was created, let‚Äôs check our database. Head to mLab and go to
the collections in your database.

collections in our database

We can see above that a new collection was created named ‚Äòproducts‚Äô and has
one document.

Read
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

The second task in our CRUD app is to read an existing product. Let‚Äôs do the
route.

// routes/products.route.js
...
router.get('/:id', product_controller.product_details);

Now let‚Äôs write the product_details controller in our controller le. Head to
controllers/product.controller.js and paste the following code.

// controllers/products.controller.js
exports.product_details = function (req, res) {
Product.findById(req.params.id, function (err, product) {
if (err) return next(err);
res.send(product);
})
};

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

What the function does is it simply reads an existing product from the product
id being sent in the request.
Now let‚Äôs head to Postman and try-out our new endpoint. Call the following
url ‚Äòlocalhost:1234/products/PRODUCT_ID‚Äô
PRODUCT_ID is the id of the object we‚Äôve created in the previous endpoint.
You should get this from your database and it will be di erent from mine for
sure.

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Postman get request example

We got a response containing all the info of that speci c product. You can see
that it is called appled and it‚Äôs price is 15.

Update
The third task in our CRUD app is to update an existing product. Let‚Äôs do the
route.

// routes/products.route.js
...
router.put('/:id/update', product_controller.product_update);
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Now let‚Äôs write the product_details controller in our controller le. Head to
controllers/product.controller.js and paste the following code.

// controllers/products.controller.js
...
exports.product_update = function (req, res) {
Product.findByIdAndUpdate(req.params.id, {$set: req.body},
function (err, product) {
if (err) return next(err);
res.send('Product udpated.');
});
};

What the function does is it simply nds an existing product using its id that
was sent in the request.
Now let‚Äôs head to Postman and try-out our new endpoint. Call the following
URL ‚Äòlocalhost:1234/products/PRODUCT_ID/update‚Äô

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

PRODUCT_ID is the id of the object we‚Äôve created in the previous endpoint.
You should get this from your database and it will be di erent from mine for
sure.

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Postman updaterequest example

We have updated the product name to ‚Äòapple2‚Äô and we can see a response
saying ‚ÄòProduct updated.‚Äô
We can also check the database to see if the database document was updated
successfully or not.

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Product after update

We can see that the name was succesfully changed from ‚ÄòApple‚Äô to ‚Äòapple2‚Äô
which implies that our update endpoint is working correctly.

Delete
The last task in our CRUD app is to delete an existing product. Let‚Äôs do the
route.

// routes/products.route.js
...
router.delete('/:id/delete', product_controller.product_delete);

Now let‚Äôs write the product_delete controller in our controller le. Head to
controllers/products.js and paste the following code.
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

// controllers/products.controller.js
exports.product_delete = function (req, res) {
Product.findByIdAndRemove(req.params.id, function (err) {
if (err) return next(err);
res.send('Deleted successfully!');
})
};

What the function does is it simply deletes an existing product.
Now let‚Äôs head to Postman and try-out our new endpoint. Call the following
URL ‚Äòlocalhost:1234/products/PRODUCT_ID/delete‚Äô
PRODUCT_ID is the id of the object we‚Äôve created in the previous endpoint.
You should get this from your database and it will be di erent from mine for
sure.

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Postman delete request example

We get a success message stating ‚ÄòDeleted successfully‚Äô in the body of our
response.

. . .
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Done üéâ üéâ

. . .

By now, we are done with creating a full API which does the four operations
(CRUD)
You can see the full code of this tutorial on the following GitHub repo.
I hope you nd this tutorial helpful. In case you have any questions kindly
leave a comment below.
PS: I am new in writing tech tutorials. I would love to hear your feedback to
improve my future writings¬†:-)
Cheers! üçª

‚úâ Subscribe to CodeBurst‚Äôs once-weekly Email Blast, üê¶ Follow CodeBurst on
Twitter, view üó∫ The 2018 Web Developer Roadmap, and üï∏ Learn Full
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Stack Web Development.
Nodejs

Expressjs

Web Development

API

JavaScript

50

3K claps

Eslam Maged

codeburst

Follow

Software Engineer üë®üíª |
Full-time learner üìö

Follow

Bursts of code to power
through your day. Web
Development articles,
tutorials, and news.

More from codeburst

More from codeburst

More from codeburst

Large O ine Datasets with Apollo
Client

Progressive Web Applications: A
Progressive State of the Web

How to use HTML5 form
validations with React

John Tucker
Jan 26 ¬∑ 3 min read

481

Tarique Ejaz
Jan 22 ¬∑ 8 min read

Create PDF in your applications with the Pdfcrowd HTML to PDF API

578

Sonny Recio
Jan 15 ¬∑ 11 min read

259

PDFCROWD

Responses

Write a response‚Ä¶

Conversation between Poorna Rao and Eslam Maged.

Poorna Rao
May 21, 2018

Nice tutorial I enjoyed doing this..
1 response

12

Eslam Maged
May 21, 2018

That‚Äôs great. Happy learning!¬†;)
1

Conversation between Harshit Kaushik and Eslam Maged.

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Harshit Kaushik
Jun 16, 2018 ¬∑ 1 min read

Hi Eslam
Firstly, congrats on writing a tech tutorial if you‚Äôre new to this. Writing an
article needs e orts and this was a good read. I hope you continue to write
more tutorials.
Some suggestions from my side after following this article step by step.
1. We can use const and‚Ä¶
Read more‚Ä¶

1 response

25

Eslam Maged
Jun 19, 2018

Hi Harshit,
Thanks a lot for your constructive feedback. Yes, I am totally new to writing
tech tutorials and feedbacks like yours are the ones which would make me a
better writer, hopefully¬†:-)
I have updated the articles based on your rst two points, yet I do not really
understand what you do mean with the third point.
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

1 response

11

Harshit Kaushik
Jun 23, 2018 ¬∑ 1 min read

Hi Eslam
Thank you for taking my suggestions in a good shade. What I meant in my
third point was that if you read some good answers in this stack over ow
question (https://stackover ow.com/questions/6203231/which-httpmethods-match-up-to-which-crud-methods), what HTTP method we use
implies some purpose of that method,
Read more‚Ä¶

1 response

3

Eslam Maged
Jun 23, 2018

Ahhhh, I get it now. Makes perfect sense! Thanks a lot!
I am so looking forward for your feedback on my future articles.
11

Applause from Eslam Maged (author)
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Olutunmbi Banto
Aug 29, 2018

Thanks for this article. Well explained, details and step by step guide. I found
it very helpful.
3

Applause from Eslam Maged (author)
mallikarjun hanaval
Aug 14, 2018

Thank you for your valuable article Sir..
1

Applause from Eslam Maged (author)
Alex Richards
Oct 30, 2018

Great tutorial! Very straightforward and presented important concepts in a
very simple way.
1

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Conversation between Lukas G. and Eslam Maged.

Lukas G.
Jun 11, 2018

Nice tutorial! Totally needed this and didn‚Äôt know about Postman and mLab
so that I can test this out. By the way, on the DELETE portion of the CRUD
write-out, you wrote that title as ‚ÄúRead,‚Äù is that right or is it supposed to be
‚ÄúDELETE‚Äù?
1 response

3

Eslam Maged
Jun 12, 2018

I am so happy you found this useful.
It is supposed to be ‚ÄúDelete‚Äù. Updated¬†;-)
1

Conversation between x and Eslam Maged.

x
Jun 26, 2018

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Hello!
First and foremost: thank you for this tutorial!
I‚Äôm trying to post to ‚Äò/products/create‚Äô from the JS le itself, not through
Postman. How do I do this?
1 response

1

Eslam Maged
Jul 14, 2018

hi,
You will need to build a form to mimic the post request. What‚Äôs wrong with
using an HTTP client such as postman to speed-up your development process?

Applause from Eslam Maged (author)
Vidhya Yadav
Oct 23, 2018

Great Tutorial and very helpful for me.
1

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Applause from Eslam Maged (author)
Resmi Warrier
Jul 8, 2018

Thanks for the article
1

Applause from Eslam Maged (author)
Sanghamitra Bhattacharyya
Jun 21, 2018

Very helpful article.Now I understand total crud generation.
Thanks a lot!!!!
4

Applause from Eslam Maged (author)
Vaibhav Gupta
Oct 11, 2018

Thanks man¬†, you made it look so easy¬†:-)
1
Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Applause from Eslam Maged (author)
Hern√¢ni Gil
Oct 26, 2018

your tutorial made my start in node js so easy. thanks a lot
1

Applause from Eslam Maged (author)
Aaron
Aug 8, 2018

Thank you for a clear and succinct description.
1

Applause from Eslam Maged (author)
Ayoub Jamouhi
Jun 25, 2018

Thank You Man
4

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

Applause from Eslam Maged (author)
Shilpa
Oct 9, 2018

This one is very detailed and informative.
1

Applause from Eslam Maged (author)
Aurora Ch√©rie
Aug 23, 2018

Awesome tutorial. It helped me alot
1

Conversation with Eslam Maged.

Kevin Lai
Jun 25, 2018

Has anyone got an error of ‚ÄúCannot POST /products/create‚Äù when making a
post request in Postman?
1
Create PDF in your applications with the Pdfcrowd HTML to PDF API

4 responses
PDFCROWD

Eslam Maged
Jun 25, 2018

Hi Kevin,
Compare your code to the one on GitHub (
https://github.com/Eslamunto/ProductsApp ) and let me know if you are still
facing a problem.

Show all responses

Create PDF in your applications with the Pdfcrowd HTML to PDF API

PDFCROWD

